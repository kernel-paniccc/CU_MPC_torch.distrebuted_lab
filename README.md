# crypten-linreg
## Homework 1. linreg
---
##### Выполнил: Ручкин Иван

Цель работы : Обучить модель линейной регрессии на объединённых данных двух сторон с использованием CrypTen (MPC) и Trusted Third Party (TTP) для генерации троек Бивера.

**В ходе раюботы было**:
- Реализована загрузка и объединение данных в зашифрованном виде с помощью CrypTen.
- Собрана и обучена модель линейной регрессии в режиме MPC с применением Trusted Third Party (TTP) для генерации троек Бивера.
- Проведено тестирование итоговой модели на тестовой выборке.
- Получены и проанализированы логи процесса обучения и тестирования.

#### Итог: Модель успешно обучена в распределённой среде с помощью MPC и TTP. Логи, подтверждающие корректную работу и финальную метрику, сохранены в файле:

`/solve/ans_log.txt`

```angular2html
...
worker2-1  | 2025-10-05 22:52:36,923 [INFO]: Test MSE: 0.0645904541015625
worker1-1  | 2025-10-05 22:52:36,923 [INFO]: Test MSE: 0.0645904541015625
...
```

---

Обучение линейной регрессии в CrypTen.

Скрипт генерации данных и открытое обучение линейной регрессии в pytorch в `notebooks/linreg-plain.ipynb`.

Для запуска:
1. Указать в `docker-compose.yml` в разделе `command` для каждого воркера нужную функцию из `src/tasks/mpc.py`.
2. Выполнить `docker compose up`.

После внесения изменений в код:
1. Остановить и удалить прерыдущие контейнеры: 
```bash
docker compose down
```

2. Запустить, пересобрав новые образы:
```bash
docker compose up --build
```
